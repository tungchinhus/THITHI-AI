<div class="flex flex-col h-full bg-white font-sans p-6">
  <h2 class="text-2xl font-bold mb-4" style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem; color: #1f2937;">
    üîç T√¨m Ki·∫øm Th√¥ng Minh (Vector Search)
  </h2>

  <!-- Search Form -->
  <div class="bg-gray-50 rounded-lg p-4 mb-6" style="background-color: #f9fafb; border-radius: 0.5rem; padding: 1rem; margin-bottom: 1.5rem;">
    <div class="mb-4">
      <label class="block text-sm font-medium text-gray-700 mb-2" style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.5rem;">
        C√¢u h·ªèi / T·ª´ kh√≥a
      </label>
      <div class="flex gap-2">
        <input
          type="text"
          [(ngModel)]="query"
          (keyup.enter)="onSearch()"
          placeholder="V√≠ d·ª•: T√¨m m√°y b∆°m c√¥ng su·∫•t 5HP"
          class="flex-1 px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
          style="flex: 1; padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem;"
          [disabled]="isSearching"
        />
        <button
          (click)="onSearch()"
          [disabled]="isSearching || !query.trim()"
          class="px-6 py-2 bg-indigo-600 text-white rounded-md font-semibold hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"
          style="padding: 0.5rem 1.5rem; background-color: #4f46e5; color: #ffffff; border-radius: 0.375rem; font-weight: 600; border: none; cursor: pointer;"
        >
          <span *ngIf="!isSearching">üîç T√¨m ki·∫øm</span>
          <span *ngIf="isSearching">‚è≥ ƒêang t√¨m...</span>
        </button>
      </div>
    </div>

    <!-- Advanced Options -->
    <div class="grid grid-cols-3 gap-4" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1" style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">
          B·∫£ng
        </label>
        <input
          type="text"
          [(ngModel)]="tableName"
          class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"
          style="width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-size: 0.875rem;"
        />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1" style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">
          S·ªë k·∫øt qu·∫£
        </label>
        <input
          type="number"
          [(ngModel)]="topN"
          min="1"
          max="50"
          class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"
          style="width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-size: 0.875rem;"
        />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1" style="display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">
          Ng∆∞·ª°ng similarity
        </label>
        <input
          type="number"
          [(ngModel)]="similarityThreshold"
          min="0"
          max="1"
          step="0.1"
          class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"
          style="width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-size: 0.875rem;"
        />
      </div>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="bg-red-50 border border-red-200 rounded-lg p-4 mb-4" style="background-color: #fef2f2; border: 1px solid #fecaca; border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;">
    <p class="text-red-800 text-sm" style="color: #991b1b; font-size: 0.875rem;">‚ùå {{ errorMessage }}</p>
  </div>

  <!-- Results -->
  <div *ngIf="results.length > 0" class="flex-1 overflow-y-auto">
    <div class="mb-4" style="margin-bottom: 1rem;">
      <p class="text-sm text-gray-600" style="font-size: 0.875rem; color: #4b5563;">
        T√¨m th·∫•y <strong>{{ totalResults }}</strong> k·∫øt qu·∫£
      </p>
    </div>

    <div class="space-y-4" style="display: flex; flex-direction: column; gap: 1rem;">
      <div
        *ngFor="let result of results; let i = index"
        class="bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"
        style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 1rem; transition: box-shadow 0.2s;"
      >
        <div class="flex items-start justify-between mb-2" style="display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 0.5rem;">
          <div class="flex items-center gap-2" style="display: flex; align-items: center; gap: 0.5rem;">
            <span class="text-sm font-medium text-gray-500" style="font-size: 0.875rem; font-weight: 500; color: #6b7280;">
              #{{ i + 1 }}
            </span>
            <span class="text-xs px-2 py-1 rounded" style="font-size: 0.75rem; padding: 0.25rem 0.5rem; border-radius: 0.25rem; color: #ffffff;"
                  [style.background-color]="getSimilarityColor(result.similarity)">
              {{ formatSimilarity(result.similarity) }} match
            </span>
          </div>
          <span class="text-xs text-gray-400" style="font-size: 0.75rem; color: #9ca3af;">
            ID: {{ result.id }}
          </span>
        </div>
        <p class="text-gray-800" style="color: #1f2937; line-height: 1.6;">
          {{ result.content }}
        </p>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isSearching && results.length === 0 && query" class="text-center py-12" style="text-align: center; padding: 3rem 0;">
    <p class="text-gray-500" style="color: #6b7280;">
      Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o. Th·ª≠ ƒëi·ªÅu ch·ªânh ng∆∞·ª°ng similarity ho·∫∑c t·ª´ kh√≥a kh√°c.
    </p>
  </div>

  <!-- Initial State -->
  <div *ngIf="!isSearching && results.length === 0 && !query" class="text-center py-12" style="text-align: center; padding: 3rem 0;">
    <p class="text-gray-500" style="color: #6b7280;">
      Nh·∫≠p c√¢u h·ªèi ho·∫∑c t·ª´ kh√≥a ƒë·ªÉ b·∫Øt ƒë·∫ßu t√¨m ki·∫øm th√¥ng minh
    </p>
  </div>
</div>
